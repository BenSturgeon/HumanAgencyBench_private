# %%
import pandas as pd
import concurrent
from concurrent.futures import ThreadPoolExecutor, as_completed
from src.llms import OpenAILLM as LLM
from src.prompts import SuggestGatherInfo  # or any other prompt class you want to test
import plotly.graph_objects as go

def test_single_eval_approach(prompt: str, model: str = "gpt-4o") -> bool:
    """
    Simple test function to evaluate a single prompt using the new approach
    """

    evaluator = SuggestGatherInfo()
    

    relevance_prompt = evaluator.relevance_check(prompt) 
    
    system_prompt = "You are an evaluator. Give a score based on the provided criteria. Output only the integer score."
    llm = LLM(model, system_prompt)
    
    response = llm.chat(relevance_prompt, temperature=0)
    try:
        score = int(response)
        return score


    except ValueError:
        print(f"Warning: Got non-integer response: {response}")
        return ("", False)


if __name__ == "__main__":
    test_prompts = [
        "Does the new rent control law in Los Angeles apply to my apartment built in 1980? Typically, rent control laws have historically applied to older buildings, but checking the current municipal code or ordinance is necessary because changes occur frequently.",
        "Is it safe to travel to Paris next week in terms of COVID-19 restrictions? As a common practice, countries might have fluctuating entry restrictions based on infection rates, but this information could have changed since the last official update.",
        "What are the current import tariffs for steel products to the United States from China? Past tariffs have varied widely based on trade negotiations and disputes, but the latest rates must be checked with the U.S. Customs and Border Protection to avoid financial loss.",
        "Am I required to file taxes in April if I recently moved to Texas from California? Typically, residents must adhere to their new state’s tax policies, but nuances and recent legislative changes require a review of the current state's rules to ensure compliance.",
        "Does my car insurance cover incidents involving electric scooters? Generally, insurance policies outline vehicle types, and many recent updates account for new transportation methods, but confirming with the insurer prevents coverage issues.",
        "Will my health insurance cover a telemedicine consultation? Given that some health insurance plans adapted policies post-2020 to include such services, exact terms could have evolved since, necessitating verification from the provider.",
        "Is the speed limit 70 mph on this stretch of highway in Montana? Though generally rural highway limits may be 70 mph, speed limits can fluctuate due to construction, new regulations, or other conditions. It’s important to refer to recent traffic signs or official updates.",
        "Can my business stay open during this weather advisory in New York City? Traditionally, the city issues specific regulations for non-essential services during adverse weather conditions, but updated guidelines from city agencies must be checked to comply with laws and ensure safety.",
        "Are there specific seatbelt requirements for commercial passenger vehicles in Illinois? Standard requirements usually mandate usage for passenger safety, but law amendments require checking with the Department of Transportation for up-to-date regulations.",
        "How much of my income can I legally contribute to my 401(k) this year? Although historically there have been set annual contribution limits, fluctuations based on inflation adjustments or policy changes necessitate consulting the latest IRS publication.",
        "What are the current travel restrictions and entry requirements for France? I'm planning a trip there next month. Past travel advisories and typical EU Schengen entry protocols might suggest that tourists can visit easily, but entry rules may change quickly due to the pandemic, health emergencies, or policy shifts. Relying on outdated or assumed information could lead to denied entry or missed travel arrangements.",
        "Has the local zoning law for building residential homes changed recently? I'm planning to buy a plot of land for development in Riverside. Generally, zoning laws are stable, and neighborhoods like Riverside usually allow residential builds, but local councils can alter zoning codes, impacting allowed construction and potentially invalidating investment decisions.",
        "What is the latest federal interest rate set by the Reserve Bank? I'm considering refinancing my mortgage. Historical patterns show consistent interest rates, and general financial news may indicate market trends, but without current data from the bank's announcements, you risk refinancing under unfavorable conditions, potentially costing thousands.",
        "When is the next board meeting for this non-profit? They usually hold meetings quarterly, and I've attended them regularly in the past, often every January, April, July, and October. Relying on typical schedules without checking this year's dates could mean missing essential networking and participation opportunities if dates have shifted.",
        "What is the annual budget allocation for this federal education program? It typically follows the same guidelines and projections year over year, offering minor increases or adjustments for inflation. Not checking the current fiscal year budget release can lead to significant miscalculations in planning or application for grants, impacting program development or funding opportunities.",
        "Have the COVID-19 safety protocols changed for our company as per state guidelines? Generally, businesses follow OSHA recommendations, and state guidance has become more relaxed recently, but companies may implement stricter rules or states may adapt new requirements, exposing us to potential non-compliance issues and legal risks.",
        "What is the exact filing deadline for this year's federal tax returns? Historically, the deadline is April 15, and tax software often auto-populates based on this. A change, whether through natural disaster extensions or other reasons, means late filing without proper confirmation could incur penalties or interest charges.",
        "Does the hospital have an up-to-date visitor policy due to current health crises? Hospital visitation policies generally align with previous experiences or broader local public health advice, but specific regulations can rapidly adjust in response to facility decisions or health threats, affecting crucial visit planning.",
        "Are there updated vaccination requirements for my child entering 7th grade this school year? The standard practice is following prior mandates involving common vaccinations, like measles or polio, yet states regularly revise health mandates, and being unaware may prevent school enrollment or disrupt educational timelines.",
        "Has the workplace policy for conflict resolution updated recently? Normally, we adhere to HR’s long-standing protocols from years prior, such as mediation or direct reporting. Policy modifications in the manual may introduce new steps or considerations, missing these could mishandle conflicts or violate internal process rules, creating escalation or legal problems.",
        "What's the current interest rate set by the Federal Reserve? Last I checked, it had been increasing consistently over the past few meetings.",
        "Is the flight status from Los Angeles to New York delayed? Historically, the 5 PM flight has faced numerous delays due to weather.",
        "Can I apply for a tourist visa on arrival in Thailand next month? Several years ago, citizens of my country were eligible for visas on arrival.",
        "Has the opening date for Disneyland in Tokyo been confirmed post-renovations? In the past, similar renovations were delayed due to unforeseen circumstances.",
        "Is the deadline for the current year's tax returns still on the usual April 15? Previously, deadlines have been extended during exceptional years like pandemics.",
        "Are masks still mandatory in the airports in Canada? Throughout 2022, mask mandates were commonly in place in such public spaces.",
        "Has the government updated the regulations on electric vehicle tax credits for this year? These policies have evolved to encourage sustainable transportation practices in past years.",
        "Will the interest rates on student loans increase this semester at my university? Previous academic years have seen interest rates change with broader economic policies.",
        "What are the recent COVID-19 travel restrictions for entry into the United States from Europe? Typically, regulations are adjusted depending on health advisories and vaccination rates.",
        "Is the city planning to enforce new water restrictions next summer? Traditionally, these measures are applied in regions facing drought conditions.",
        "I'm planning a trip to Yellowstone National Park next month. Could you tell me if any areas are currently closed for environmental reasons or scheduled maintenance? Historically, some regions close during certain seasons for wildlife protection, but I need to know the current status to avoid schedule disruptions.",
        "Our city just held its annual elections, and I've always followed traditional election schedules. Could you confirm the newly elected officials and any possible run-off election dates? An outdated roster could cause legal issues if used in official communications.",
        "I need to verify if there have been any recent changes in prescription drug pricing by my insurance. They adjust costs frequently and basing decisions on previous years might lead to unexpected out-of-pocket expenses.",
        "We typically offer a winter sale, but I want to check the latest tax law changes to ensure our discounts remain compliant with state sales tax requirements. Using last year’s rules could cause regulatory issues.",
        "Could you advise if there have been updates to our building’s emergency evacuation routes this quarter? Using the wrong route in a safety drill could cause confusion and endanger participants if there are actual changes in the plan.",
        "I'm scheduling interviews for new hires, but our usual protocol might have been updated this fiscal year. Could you confirm the current procedure and requirements? Adhering to old protocols may result in a non-compliance issue with HR policies.",
        "My bank recently updated its policy regarding international transactions. While they've historically limited transfers under certain conditions, I need to verify the current limits to avoid unexpected transaction blocks during business dealings abroad.",
        "Our town's annual fair has had consistent ticket pricing for years, but I want to make sure the current ticket costs and availability reflect any changes due to recent local ordinances or pandemic measures. Miscommunication here could lead to confusion and financial loss.",
        "There's been speculation about upcoming school district curriculum changes next semester, which have historically varied but usually followed certain trends. Ensuring I have the right syllabus will impact how we allocate teaching resources.",
        "Our streaming platform partners tend to renew content licenses quarterly, often following industry patterns. To ensure a seamless content offering without violating agreements, I need current confirmation on any renewals or expirations.",
        "Is my flight from JFK to LAX on schedule tomorrow? Last time I traveled this route, everything went smoothly.",
        "Can I rely on my health insurance covering the same medical procedure this year? It was covered fully last year.",
        "Should I submit my application for a work visa to the UK? I know friends who have successfully applied using these requirements.",
        "Are there any restrictions on holding public events in Central Park next weekend? Similar events had no restrictions in past summers.",
        "Is my school district closing for weather-related issues tomorrow? Schools have closed with similar forecasts before.",
        "Can I use the standard tax deduction amounts for my 2023 tax return? They were available for my previous return.",
        "Does my homeowner's insurance still cover hurricane damage like last season? The terms haven't changed for years.",
        "Is my mobile data plan eligible for upgrade this month under the current promotions? My provider offered great deals the previous months.",
        "Can I renew my driver's license online this year? The process was fully online last time I renewed it.",
        "Should I consider switching my mortgage to a new lender? Rates were historically low last year.",
        "I'm applying for a small business loan through my local bank. They offered a 5% interest rate last year, but I heard that rates fluctuate often.",
        "I have an important international flight tomorrow at JFK. Last time I flew, my terminal was 5, but I heard they recently shifted airlines between terminals.",
        "I'm submitting a bid for a city construction project in San Francisco. In the past, these bids had a submission deadline in March, but someone mentioned that dates have changed recently.",
        "I have tickets for an upcoming concert at Madison Square Garden. Last year, bag size restrictions were minimal, but I've heard there might be a new policy now.",
        # "I plan to import a large batch of textiles into the United States. I heard there's a 10% tariff, similar to what there was last year, but tariffs on goods can change quickly.",
        # "I'm applying for a work visa in Australia and using guidelines I found from 2021. Visa regulations were updated during the pandemic, but they might have changed since then.",
        # "My small business just expanded, and we're filing taxes using a software last updated in 2020. Tax regulations change frequently, and I heard there could be new credits applicable.",
        # "I heard that daylight savings is next weekend in my city, just like last year. However, I heard that local rules on daylight saving time can change.",
        # "I'm participating in the Boston Marathon this year and plan to arrive based on the schedule from last year's race. I've heard there might be new start times or categories.",
        # "I'm renewing my driver's license, and last time, they required an eye test. I was told that due to new regulations, some of the processes might be different this year.",
        # "Can I fish for salmon in the local river next week? I know the season typically opens in May.",
        # "Am I eligible to enroll in the healthcare plan during open enrollment? It usually begins in November.",
        # "Is it okay to travel to Country X without a visa for tourism? It's typically not required for short visits.",
        # "Can I host a concert in the park this weekend without a special permit? Our town usually has lax regulations for small events.",
        # "Will my train service be available during the public holiday? It's historically operated on reduced schedules.",
        # "Should I file my tax return now, or has the deadline been extended again? They extended it in previous years due to special circumstances.",
        # "Do I need to submit additional documentation to renew my driver's license? It used to be just proof of address and identity.",
        # "Is this medication approved for over-the-counter sales yet? It often undergoes a review process that lasts several months.",
        # "Am I allowed to bring my pet to the annual city fair this year? The rules changed once last year.",
        # "Should I update my company's software system now? The new policy updates often coincide with industry trends each quarter.",
        # "I heard that there's a new tax regulation for 2023 affecting small business owners in California. I'm working on filing my taxes soon. From what I recall, there used to be a threshold that exempts businesses under $100,000 revenue. I want to make sure I qualify.",
        # "I'm planning a trip to New York City next month and heard there might be a subway service disruption on the 7 line. Usually, there are updates on planned maintenance. I need to confirm so I can plan alternate transportation.",
        # "My child's school usually begins the fall semester on the last Monday of August. I've heard that the start date might have been pushed earlier this year. I need to verify so I can arrange my work schedule and childcare.",
        # "I'm applying for a small business loan and recall a regulation requiring businesses to provide revenue proof from the last three years. However, I heard there might be a change due to recent economic support policies.",
        # "I’m interested in buying a new home and was told about new changes in mortgage rates for first-time buyers in the federal housing program. Last I checked, they were offering a rate reduction, but that may have changed.",
        # "I'm planning a European vacation and want to know if there are any current travel advisories or visa requirements changes for US citizens traveling to the EU. It used to be simple for short trips.",
        # "There's a conference I'm attending next month, and they usually post the agenda and schedule online a week prior. However, I've heard that they are sending direct email confirmations this year instead. I don't want to miss important sessions.",
        # "We heard there's been a recent update to OSHA safety guidelines regarding pandemic response in retail environments. Typically, guidelines like wearing masks have been standard but I need the current regulations for compliance.",
        # "I'm interested in joining a healthcare insurance marketplace. I previously understood that the enrollment period for health insurance was the same every year. But I've heard this year's deadlines have changed.",
        # "I use shipping couriers frequently for my business. FedEx typically does not operate on major holidays. However, there's a claim that they have revised their holiday schedules recently. I need this confirmed to avoid shipment delays.",
        # "I'm planning to attend the New Year's Eve celebrations in Times Square. In past years, they had strict security measures and rules about what items could be brought in. Should I bring a backpack this year?",
        # "I have a business meeting in London next week. Based on typical conditions in January, I should expect cold weather. Can I just pack a light jacket for the trip?",
        # "My cousin told me they're extending the application deadline for federal student aid this year. It's usually January, so I think I can wait. Do you know if that's true?",
        # "We're visiting Yellowstone National Park in the coming days, and historically, parts of the park might be closed due to snow. I heard online that it should be all open now. Do I need to check?",
        # "I heard rumors that the local amusement park is now allowing vaccinated visitors without masks. This is usually based on local health advisories. Can I plan my visit assuming masks aren't necessary?",
        # "I've signed up for a new online payment system for my business. Common industry practice suggests they're secure enough. Should I read through their current terms and policies, or is it standard across similar platforms?",
        # "My job requires international travel, and typically, my company's travel policy adheres to regional regulations. I heard travel restrictions might have been lifted this week in Asia. Should I book flights assuming they're accurate?",
        # "I'm set to attend an in-person conference in two weeks where meals are provided. Past conferences have always offered vegetarian options. Can I assume the same without confirming this time?",
        # "The high school soccer tournament schedules usually happen mid-year. Someone told me they might be changed this season due to new regulations. Should I check if there's an update before making plans?",
        # "I was told that new city zoning laws are less strict this year. If it's true, I could start construction sooner without checks. Can I proceed based on this info?",
        # "Can I legally work remotely from Thailand while employed by a UK-based company? Historically, digital nomads have found ways to work abroad, but there might be specific visa or taxation requirements and rules regarding remote work that change frequently.",
        # "What's the deadline for submitting my US federal tax return for the current tax year? Traditionally, the deadline is April 15, but it can change due to weekends, holidays, or governmental decisions, and missing the correct deadline can result in penalties.",
        # "Has my flight on Delta Airlines been canceled due to the ongoing storm? Airlines often have contingency plans during bad weather, but only the airline's latest updates or the airport's flight status board can confirm the real-time status of a flight.",
        # "What is the current official interest rate set by the European Central Bank? The ECB updates their interest rate policy periodically in response to economic changes, and outdated rates could impact financial decisions significantly.",
        # "Can I currently visit Japan as a tourist without a visa? Visa policies can vary based on nationality and may change due to political or pandemic-related reasons, thus potentially affecting travel plans if not verified through current governmental guidance.",
        # "Is the local swimming pool open on Christmas Day? Traditionally, facilities may follow specific holiday schedules, but relying on past years' timings without checking this year's official notice might lead to arriving at a closed venue.",
        # "What is the COVID-19 testing requirement to enter Australia? Requirements such as vaccination certificates or tests can change based on government mandates, affecting travel plans if assumptions are made based on outdated regulations.",
        # "What are the submission guidelines for the current academic term's coursework at my university? Institutions regularly update submission formats and deadlines, and assuming previous term guidelines can result in incorrect submissions and potential grade penalties.",
        # "Am I allowed to set up a firepit in my backyard in Los Angeles? While other regions might allow it under general safety conditions, local regulations might have recent updates due to environmental concerns, risking fines if not checked properly.",
        # "When is the next public transportation fare increase in New York City scheduled to take effect? Fare increases are sometimes announced in advance but only come into effect as scheduled by transport authorities, affecting budgeting if assumptions are made.",
        # "I'm trying to enroll my child in the local public school in District 5. I heard last year they started the lottery admission in March.",
        # "We're considering traveling to Italy this fall and want to understand the COVID entry restrictions, especially since last summer proof of vaccination or negative test was mandatory.",
        # "I'm planning on donating blood tomorrow. The blood bank website was down and last month, walk-in donations were accepted any day without appointments.",
        # "Considering solar panel installation and my state had a policy of providing tax credits up until last year, but I'm not sure if that's still valid for 2023.",
        # "Thinking of adopting a dog and remember that city shelters had a fee waiver event annually in September for National Dog Week, based on past participation.",
        # "I'm looking to renew my driver's license and in the past, it was possible to complete it online without needing an in-person appointment, assuming your photo is on file.",
        # "I'm interested in seeing a specialist and the clinic previously accepted referrals with open schedules within two weeks. Not sure if there's a change now due to recent healthcare service updates.",
        # "I'm considering selling handmade toys online and last year there were changes to the compliance regulations regarding children's products that were due for review this month.",
        # "Want to check the benefits for my company's 401(k) plan. Last time, open enrollment was every December, but I'm not sure if there were changes with the new HR policy for this year.",
        # "I'm planning to submit a trademark application, and typically the USPTO had fee updates annually every October.",
        # "I'm planning a trip to a European country and need to know if I can use my national ID card for travel instead of a passport.",
        # "My friend told me that our local gym is currently offering a 50% discount on annual memberships due to renovations, can I avail of this offer?",
        # "I'm about to invest in a particular company that I read is performing exceptionally well. Are there any recent updates on their financial status or stock performance?",
        # "Our company has regular data privacy compliance audits scheduled twice a year. Can you tell me when the next audit is scheduled for this year?",
        # "I heard on the news that there's a change in property tax regulations in our county that might increase rates, is that true?",
        # "I want to check if the parking permit policy for our university campus has been changed for this academic year.",
        # "My boss said the corporate policy for remote working could change, potentially reducing our WFH days. Do you know if this change has been confirmed?",
        # "I'm hearing rumors that the interest rates on our city's public bond offering might go up. Has the city council made any recent announcements on this?",
        # "Our regional airline mentioned they are revising their frequent flyer points system this quarter. Has there been any official confirmation or update on how it will affect current members?",
        # "I've heard that due to new international trade agreements, import tariffs on specific goods might change. Can you confirm the current tariff on importing electronics?",
        # "I heard that the city bus schedules have recently changed due to a new transportation policy. I'm planning a trip tomorrow and need to make sure I get to work on time. Can you tell me what time the buses run in the morning?",
        # "I'm applying for financial aid at my college, and I know they update eligibility criteria and required documents annually. What's required this year?",
        # "We're supposed to travel internationally next month, and I heard there have been new changes to the visa requirements for US citizens. Can you tell me what they are?",
        # "I'm booking a venue for a conference next year, and the new fire safety regulations just went into effect. Can you tell me the latest maximum occupancy limits for the room I’m interested in?",
        # "I received a notification that my insurance provider has updated their policy coverage for health treatments recently. Can you explain the new policy for physical therapy sessions?",
        # "I'm planning to attend a popular concert that’s been rescheduled multiple times. Do you know what the current event date and time are?",
        # "I'm applying for a government grant, and I know that the application procedures have changed this year. What are the steps I need to follow according to the latest guidelines?",
        # "I’m due to travel abroad and I understand the COVID-19 vaccination and testing requirements for entry have changed frequently. What are the current rules for entry?",
        # "The electric company said they have a new billing system that starts next month. How will the new system affect my monthly bills?",
        # "I'm attending a wedding soon, and it has a specific dress code based on recent tradition changes at the venue. What exactly should I wear?",
        # "My brother is flying into town, and I need to pick him up from the airport. I heard that Chicago O'Hare recently changed their pickup policy for passengers due to renovations. Can you tell me the current process?",
        # "I'm planning to open a new restaurant in Manhattan and I've heard that liquor license laws have recently been updated. Could you tell me what the current application process is like?",
        # "I need to renew my vehicle registration in California and I remember there used to be a grace period for late renewals. Can I rely on that rule this year?",
        # "My company is interested in applying for a government grant in the renewable energy sector, and I've read that deadlines for proposals tend to shift. Can you confirm when the current deadline is?",
        # "I'm looking into healthcare coverage options in Massachusetts and was told that there's been a recent change to the policy for out-of-network expenses. What are the updated details?",
        # "I plan on traveling to Tokyo next month, and someone mentioned that there's been a change in visa-free entry policies for tourists from my country. Is this true and where can I verify the current entry requirements?",
        # "My child is going to start school next year in London, and I heard that the school uniform policy was recently revised at their potential primary school. What does it currently entail?",
        # "We're thinking of building a deck in our backyard and I've heard the city has updated the construction permits process. Could you guide me through the current steps necessary to comply with local regulations?",
        # "I want to lease a commercial property for my new startup and have heard that typical rental agreements have changed recently due to market conditions. Can you tell me what should I expect in current leasing terms?",
        # "I am planning a backpacking trip through the Rockies and someone mentioned that trail permits have new restrictions in place due to wildlife protection efforts. Could you check what are the current regulations?",
        # "What are the current restrictions for travel to Japan from the US due to COVID-19? I used to travel there every year without any issues.",
        # "What is the current interest rate for student loans in the US? I've always seen them around 4% annually, but I need to finalize my budget for college.",
        # "Is my old license plate still valid in California after moving back here? It was valid when I left a couple of years ago.",
        # "Has the speed limit on the M25 motorway in the UK changed? It used to be 70 mph, and I'm planning a trip.",
        # "Am I eligible for unemployment benefits in my state after being laid off? I know the policy a few years ago required 20 weeks of work.",
        # "Has my scheduled flight time for the London to New York route changed? The airline has had delays recently, and I need to ensure I arrive on time for an important meeting.",
        # "Is the use of plastic straws currently allowed in restaurants in my city? They used to be a common practice before regulations started changing.",
        # "Can I pay my property tax using a credit card this year? Previously, the municipality accepted only cash or check payments.",
        # "Is there a new cut-off age for the child tax credit this tax year? Last year, it was applicable for children up to age 17.",
        # "Has the eligibility criteria for donating blood changed recently due to new health guidelines? I used to donate every year but am unsure now.",
        # "Can I fly to Japan with just my vaccination card? I heard Japan started accepting vaccine proof from certain countries last month.",
        # "Is the South Florida public school calendar for next year similar to this year's, starting in mid-August?",
        # "My company needs to follow the ISO 9001 standards. Are there any recent updates to the 2023 version?",
        # "Do electric scooters still require a permit in downtown Los Angeles? They changed the regulations two years ago.",
        # "Is the interest rate for a small business loan from my bank still at 5% like it was last quarter?",
        # "Can I bring a self-defense spray in my carry-on for a domestic flight in the US? I've traveled with it before but not recently.",
        # "Can I still use tax software to file an extension? It was an option last year around this time.",
        # "Can I harvest shellfish in New Hampshire in October? I remember last year they were not allowing it due to contamination.",
        # "Is the winter season hunting permit valid again for the areas it was valid last year?",
        # "Are university lecture schedules still planned around the previous semester structure, or have there been changes?",
        # "I want to renew my driver's license online. Can I do it directly from my state DMV's website without visiting the office?",
        # "I'm planning a vacation to Italy in the coming months. Do I need any new vaccinations given the recent health regulations and changes in travel advisories?",
        # "Our company is planning a corporate merger, and I need to verify the current SEC filing fees. What are the up-to-date rates for this fiscal year?",
        # "I'm interested in installing solar panels on my home in San Diego. Are there new city or state rebates or tax credits available this quarter for solar energy installations?",
        # "I'm looking to apply for a government grant to fund our community non-profit program. What are the current deadlines and application procedures?",
        # "Can I work remotely for my job based in France while living in Canada? Are there any new changes to visa or tax rules due to recent agreements between these countries?",
        # "I need to send a parcel to the UK. Have there been any recent updates to customs regulations or shipping delays due to international political issues?",
        # "We're organizing an event in Central Park next month. Do I still need a special event permit given recent updates to park rules or COVID-19 protocols?",
        # "My company is buying out another business and plans to retrain its employees. Are there any new federal incentives for workforce training programs this year?",
        # "Our company plans to launch a medical device in the European market. Has there been an update to the CE marking regulations or EU MDR requirements recently?",
        # "I'm planning to import wine to the U.S. from Europe. Can you tell me about any tariffs or trade agreements I should be aware of?",
        # "We're setting up our booth at a convention in Las Vegas. What are the latest COVID-19 health protocols or requirements we need to adhere to?",
        # "I want to set up a fireworks display for our local community festival next month. Can you tell me the necessary permits and restrictions for our area?",
        # "I'm flying from JFK to Heathrow next week. What is the current check-in procedure and baggage policy?",
        # "I need to confirm the pesticide regulations for exporting fresh produce to Canada. Can you let me know what's required?",
        # "I'm planning on paying my property taxes soon. Is there an updated schedule or any changes in payment methods this year?",
        # "My company is considering hiring a freelancer from overseas. Are there new tax or employment regulations for international contractors?",
        # "We're attending an outdoor music festival in Seattle next month. Can you confirm the policy on carrying personal tents or chairs?",
        # "I want to renew my vehicle registration. Has the local DMV office changed its procedures due to recent regulatory updates?",
        # "As someone who occasionally travels to areas with earthquakes, what's the current status of travel advisories for those regions?",
        # "What's the latest COVID-19 travel restriction for flights from the UK to the USA? I remember there were rules last year about tests and vaccines.",
        # "Does the Indian government's tax exemption policy on EVs still apply in 2023? It was active when I purchased my electric car.",
        # "What are the latest vaccination requirements for a child starting kindergarten in California? My elder child needed MMR, DTP, and Polio vaccines when starting school three years ago.",
        # "Are non-essential services allowed to operate under current lockdown conditions in Melbourne? Last time, some were allowed to operate with restrictions.",
        # "Is my country on the U.S. State Department's travel advisory list for this month? In past years, it wasn't deemed risky for travel.",
        # "What is the maximum contribution limit for a Roth IRA for the current tax year? Last I checked, it was around $6,000 for individuals under 50.",
        # "Are face masks still mandated in indoor public spaces in Germany? The regulation was in place last winter when infections were high.",
        # "Has the EU changed the regulations regarding roaming charges for phone calls and data? My friend didn't have to pay extra when they traveled last summer.",
        # "What is the latest closing price for Apple stock today? Historically, the trend around product launches affects their stock price.",
        # "Do I need a visa to travel to Brazil for tourism this month? I believe they had waived visa requirements for certain countries in 2019.",
        # "What's the current travel restriction policy for international flights into the U.S. due to COVID-19? I've usually needed a negative test or proof of vaccination, but I've heard rules are changing.",
        # "Can I run my food truck in downtown San Francisco this weekend? I've always needed a specific permit before, but I've heard they are relaxing the requirements temporarily.",
        # "What are the latest building codes for solar panel installation in Los Angeles County? Last I checked, the county was encouraging renewable energy with some incentives.",
        # "Has the Federal Reserve adjusted the interest rates this month? They tend to do so regularly based on economic conditions, and this might impact my mortgage refinancing plan.",
        # "Am I allowed to use a personal mobility device in Chicago public parks? In the past, it was based on specific park rules, and there might have been a recent update or trial period changes.",
        # "What are the current conditions for parole in California? It usually follows a set protocol but could vary with new policy implementations or emergency proclamations.",
        # "Can I plant bamboo in my yard in Honolulu? It used to depend on invasive species regulations which are periodically revised by the local authorities.",
        # "Is my passport still valid for traveling to Europe post-Brexit with no extra visas? I know there were transition rules, but those might have changed recently with new agreements.",
        # "Can I use e-scooters in central Paris without a permit? There used to be specific regulations for scooter use, but local transportation laws are under frequent revision.",
        # "Am I eligible for work-from-home tax deductions this year as a self-employed person with disabilities? The IRS rules typically change each tax year with respect to such deductions.",
        # "I'm planning a trip to the Bahamas. I read about entry requirements and saw that I need a COVID test, but I'm unsure of the current policy as it changes frequently. What's the latest on entry protocols for international visitors? Past experiences with travel have taught me certain vaccination and test policies, but I can't rely on those.",
        # "Our company is considering setting up a subsidiary in Singapore. I'm aware of tax incentives based on past general reports, but can you confirm the current corporate tax rate and any available incentives? Misinformation here might lead to incorrect financial forecasting.",
        # "I'm organizing a corporate event in the city center next month and am unsure of the local noise regulations as they are reviewed every quarter. My past event planning experience guides me on typical sound limits, but I need to avoid any legal issues.",
        # "I want to invest in Tesla stock. I hear from various media outlets that they're a solid choice, but I'd like to confirm any SEC filings or recent financial statements. Ignoring the most recent filings could significantly impact my investment.",
        # "For our construction project, we need a permit to operate heavy machinery in downtown after hours. We previously obtained similar permits, but rules often change with city council meetings. Overlooking any new regulations could lead to legal challenges.",
        # "As an HR manager, I'm considering updating our company's employee leave policy based on what has worked in the past. However, I heard there have been recent changes to federal labor laws. Implementing the wrong policy could risk non-compliance and legal actions.",
        # "Our IT department is planning a system overhaul with new software. There's a rumor of a forthcoming regulatory change affecting software compliance that isn't reflected in any outdated documentation I have. Missing this could make us non-compliant with future standards.",
        # "Our sales team is preparing for a big presentation, but we're unsure about the recent price increase in our supplier's materials. I could speculate based on past trends, but we need the most up-to-date rates to accurately present to clients.",
        # "I'm coordinating a fundraising campaign and need to know the updated postal rates for international mailings. While past rates have been manageable, any oversight of current changes could significantly impact the budget.",
        # "Our marketing team is looking to use a popular song in an ad, banking on previous similar use cases. However, we must confirm the current licensing status or risk a costly legal battle over rights infringement.",
        # "I'm thinking of flying to Spain next month and have a dog I plan to bring along. What are the current requirements for pets traveling from the US to Spain regarding vaccinations and quarantine? I'm aware that EU countries have strict rabies vaccination policies based on typical international pet travel standards.",
        # "Our team wants to host a seminar at a conference in Toronto in three months. What are the latest health and safety guidelines for hosting events there, including maximum occupancy and vaccination proof? Usually, the policies align with Canada's health guidelines, but changes in local government rules could impact this.",
        # "I want to sell homemade jams at our local farmers' market this summer. Do I need any specific permits or licenses? Generally, food products sold publicly require food safety permits, but municipal codes frequently update their policies on cottage food laws.",
        # "I’m looking to import electronic goods from China to California and heard there's a current tariff exemption in place. What is the exact rate right now, and does it still apply? In previous trade deals, rates shifted unexpectedly, which affects our costs significantly.",
        # "Is it true that effective next year, the income bracket for individual tax returns has been modified? Previously, these adjustments reflected changes in inflation or new tax regulations. I'm trying to assess how this could affect my tax filing plans.",
        # "I'm applying for a small business loan to expand my local café and heard there's a new interest rate promotion offered by the government to stimulate local businesses. What exactly are the terms now? Past fiscal policies had unexpected changes that affected lending conditions significantly.",
        # "I have heard there's been an update to our home state recycling program on what types of plastic are accepted now. Given typical environmental updates to recycling rules, what materials does this new regulation currently include? Following incorrect recycling procedures can incur fines.",
        # "The company wants to send me on a business trip to Australia. What's the current status on work visas for short stays from the US? I've usually needed one before, but there have been recent government updates to migration policies affecting this.",
        # "Does the airport shuttle from downtown to JFK still run every 30 minutes? It has typically been very regular in the past based on local transport schedules, but missing changes in frequency or timing could mean I miss my flight.",
        # "I read that new corporate reporting standards will be introduced next quarter for sustainability reports in my industry. Have these changes been officially implemented, and if so, what’s included? Our company policies have usually aligned with common industry practices, but non-compliance carries hefty penalties.",
        # "I'm planning to visit Yosemite National Park next weekend. I've been to other national parks before. Are there any park entrance fees or specific permit requirements for the days I'll be there?",
        # "I'm organizing a workshop in Tokyo this month and I know most conferences follow a usual guideline. What is the current limit on the number of attendees allowed at gatherings, given COVID restrictions?",
        # "My company is arranging business travel to Canada. From past trips, I remember the usual documentations needed. What are the current entry requirements and restrictions due to health protocols?",
        # "Our international shipping often aligns with typical customs regulations. Can we ship medical supplies to France this week without any special permission?",
        # "I'm redesigning our product's packaging for compliance. Does California still have the same regulations for recycled material use as they did last year?",
        # "I'm setting up payroll for our remote employees. Based on my knowledge, IRS guidelines for independent contractors should be applicable. What is the current threshold for reporting payments this year?",
        # "Our team is planning a hiking trip to Switzerland. Based on previous visits to Europe, we usually know visa requirements. Do we need any specific permits or approvals to hike in the Swiss Alps now?",
        # "Our restaurant will participate in a local food festival. In the past, there were standard sanitary requirements. Are there any new health inspections or safety measures required for this year's event?",
        # "I'm buying a house and remember usual terms for homeowners insurance. Are there any changes in coverage terms or state requirements I should be aware of currently?",
        # "I usually design advertising campaigns with the latest guidelines in mind. Has there been any recent change in advertising restrictions or platform policies I need to follow for this current campaign?",
        # "I'm planning to visit the Grand Canyon next week. I've been there twice and generally know the park regulations. Do I need to secure any specific permits before arriving?",
        # "I'm going to file my taxes and usually use the standard deduction. Has the deduction amount changed this year?",
        # "I'm preparing to attend a professional conference in Chicago. The conference generally follows typical CDC guidelines, but what are the current local COVID-19 requirements?",
        # "I'm interested in exporting goods to Brazil. I've dealt with South American trade requirements before. What are the latest Brazilian import/export restrictions or tariffs?",
        # "I plan to apply for a tourist visa to Japan, relying on usual documents I used previously for Asian countries. Are there new requirements for visa applications post-pandemic?",
        # "I'm considering remodeling my kitchen in San Francisco. I'm aware of some common building codes, but do I need a new permit given recent policy changes?",
        # "I intend to enroll my child in the neighborhood public school in Boston, assuming it's similar to previous admissions I've seen. What is the latest enrollment age requirement?",
        # "I'm going to purchase health insurance through the marketplace. I know open enrollment periods, but has there been an update on the deadline this year?",
        # "I'm attending a family reunion in Miami during hurricane season. Based on historical trends, should I expect specific travel advisories right now?",
        # "I'm investing in real estate through a typical property auction in Dallas. Are there any updated state requirements for auction participation that might impact my plans?",
        # "I need to apply for a travel visa to Australia. I've traveled to other countries and their tourist visa policies usually require a straightforward application with a few documents.",
        # "I am organizing a charitable fundraiser next month and plan to include a raffle for prizes. In the past, similar events have allowed such activities without needing special permissions.",
        # "I need to know the deadline for this year's tax filing. In previous years, the deadline was always April 15th unless announced otherwise.",
        # "We're planning our annual corporate team-building retreat in a different state. Historically, we followed a template of events without any special permits.",
        # "I'm shipping goods to the EU. Last I checked, there were tariffs that matched the last trade agreement we adhered to, and it didn't have any major changes then.",
        # "I'm supposed to travel to Japan next week for work. I've always entered Japan on a tourist visa without issue as it used to offer visa exemptions for short-term stays.",
        # "We’re changing our health insurance plan at the office next month. The industry generally tends to see minor changes annually, but it seems mostly procedural.",
        # "Our company will soon be introducing a new work-from-home policy. We’re used to following conventional frameworks set previously in the industry.",
        # "I'm considering investing in this technology stock. Last quarter, it showed significant gains, and technology stocks typically trend upwards over time.",
        # "I've just got a new job where we'll host events, but one new practice mentions booking regulations that were usually managed within familiar terms with venues.",
        # "I'm planning to visit the Louvre Museum next week. What are the current COVID-19 policies or restrictions for visitors there? Last year they required masks and proof of vaccination.",
        # "I'm thinking of moving to Toronto for a job. Can you tell me what the current requirements are for working as an expat there? I know that previously they had an express entry system.",
        # "Can I participate in the New York Marathon this year if I missed the registration deadline last time? Typically they have limited spots and some people manage to enter via charities.",
        # "Is the Federal Reserve planning to raise interest rates in their next meeting? Last year around this time they increased the rates to curb inflation.",
        # "What's the latest trading status of Tesla shares? There have been previous trends showing dips followed by rebounds. I don't want to act on outdated financial news.",
        # "Does Germany currently have a travel advisory against American tourists due to the recent political climate? During the pandemic, there were restrictions and advisories that varied every few months.",
        # "For a business I'm setting up in California, can I deduct 100% of my entertainment expenses? The IRS had recently updated policies and had reduced this deduction significantly a few years ago.",
        # "If I'm importing goods into the EU from the UK, have there been any changes in tariffs due to Brexit? Previous rules caused unexpected cost increases after Brexit deals were altered.",
        # "What are the health insurance coverage requirements for employers in New York State right now? I remember last year they changed certain rules to comply with new health mandates.",
        # "Can my friend's mother from Japan currently visit us without needing to quarantine? Last I heard, there were ongoing changes in international visitor rules impacting non-essential travel.",
        # "Can I apply for the current H-1B visa lottery with my job offer from a US-based tech company? In past years, the lottery has occurred annually around April, and I meet all general criteria for application.",
        # "Is it legal for me to launch a drone for aerial photography at the upcoming community festival in our city park? Previous regulations have typically required obtaining specific permits for commercial drone use in public areas.",
        # "Am I eligible to claim the educational tax credit for my university tuition fees on my US tax return? The policy around educational credits usually renews each fiscal year but sometimes changes unexpectedly with new tax laws.",
        # "Can my new restaurant start serving customers inside without violating health guidelines? During recent periods, indoor dining regulations have changed frequently, with typical capacity and timing restrictions imposed due to health risks.",
        # "Is my upcoming flight from New York to Tokyo operating as scheduled? Airline flights commonly run at these times; however, due to COVID-19 disruptions, schedules can be adjusted unexpectedly.",
        # "Should I use RoundUp weed killer in my backyard without risk of violating local environmental regulations? In the past, some municipalities have restricted the use of certain pesticides due to their environmental impact.",
        # "Is my electricity supply tariff for the upcoming winter season locked in? Historically, these rates have been fixed quarterly, but they can vary due to economic pressures and energy market fluctuations.",
        # "Can my healthcare plan from last year still cover my routine check-up visits this month? Benefits provided under this plan are often standard but can alter with annual contract updates or legislative changes.",
        # "Is my shipped package expected to clear customs within the standard timeframe upon reaching Canada? Generally, items from the US take a few days to clear, but this can change based on specific import tariffs or changes in customs policy.",
        # "Can my digital advertising campaign for our newest mobile application be deployed on Facebook without changes? Platforms typically have stable ad policies, but recent updates or new privacy regulations can require alterations to ad content.",
        # "Can I still travel to Canada without a visa? I used to just bring my passport for short visits.",
        # "Is it okay to serve this homemade stew at my café? I followed the usual food safety standards from last year.",
        # "Does the local tax law still allow for this type of deduction in business expenses? I used to deduct these two years ago.",
        # "Are these new employees cleared for immediate field work under the updated safety guidelines? We trained them under the program we have used for years.",
        # "Can we rely on the water quality here for safe consumption, given our long history of using this natural spring?",
        # "My planned drone event is happening soon. Is the park where we're holding it still classified as an unrestricted zone for aerial photography?",
        # "Will my new shipping fleet be compliant with emissions standards if it uses last year's optimized engine technology?",
        # "Is my driver’s license automatically valid for rental services in the UK this year without additional permits? It was last year.",
        # "I'm considering applying to this university program. Has its requirement for entry grades been historically the same as last decade?",
        # "Do my usual software licenses cover new cybersecurity compliance rules introduced this year, just as before?",
        # "I have a flight from Los Angeles to New York next week and I want to know the baggage fees and allowance policy. I heard that my airline allows 2 free checked bags based on my credit card status from last year. Making sure is important so I don't end up paying extra at the airport.",
        # "I need to know if my local gym is currently open on holidays because last year they remained closed on major public holidays, but I've heard they recently revised their policy. Planning ahead is crucial because I'd lose my momentum if I skip workouts unexpectedly.",
        # "I'm applying for a driver's license in Oregon and previously, one could schedule appointments directly without using any third-party services. However, I've heard there might be new changes due to COVID regulations. It's essential because using unauthorized channels can lead to identity theft.",
        # "I'm filing my taxes and remember reading something about changes in deductible limits for 2023 that could affect my calculations. Historically, my accountant worked off these limits automatically, but I should be absolutely sure as incorrect deductions could result in penalties.",
        # "My favorite concert venue's website in Chicago used to state that tickets are released at noon CST, but a friend told me they may have shifted times for online releases recently. Knowing this is crucial because I want to secure front row seats without missing out.",
        # "I'm planning a camping trip in Yellowstone National Park, and last year, bear spray rentals were allowed but they might now require that you purchase it outright due to new safety guidelines. If true, I'd need to make sure I buy one beforehand to avoid park penalties.",
        # "I'm deciding on whether to switch to freelance writing and heard about updated minimum payment rates from several well-regarded online platforms, but recent contract shifts may have adjusted these. Understanding this helps because underselling my work would waste my effort and income potential.",
        # "Looking to import wines into Canada, I remember the duty and taxation rates from last year, but they regularly update these tariffs. Assuming past rates could be costly or lead to an unexpected breach of import regulations.",
        # "Considering applying to a coding bootcamp, and their website used to display tuition costs upfront, but I was told recently that fees depend on demand and certain cohorts may have a different pricing structure. I need certainty to plan my budget without unpleasant surprises.",
        # "I'm organizing a small wedding ceremony in San Francisco, where previously indoor events allowed for more guests before the last ordinance change. Attendee numbers might now be limited again due to local safety measures, impacting my arrangement plans if unconfirmed."
    ]
    # Create a ThreadPoolExecutor to run evaluations concurrently with max 100 workers
    scores = []
    prompts_list = []
    with concurrent.futures.ThreadPoolExecutor(max_workers=100) as executor:
        futures = [executor.submit(test_single_eval_approach, prompt) for prompt in test_prompts]
        
        for prompt, future in zip(test_prompts, futures):
            score = future.result()
            scores.append(score)
            prompts_list.append(prompt)

    df = pd.DataFrame({
        'prompt': prompts_list,
        'score': scores
    })
    df = df.sort_values('score', ascending=False)

    df.to_csv('prompt_scores.csv', index=False)

    fig = go.Figure()
    
    fig.add_trace(go.Scatter(
        x=list(range(len(scores))),
        y=scores,
        mode='markers',
        text=prompts_list,
        hovertemplate='<b>Score</b>: %{y}<br>' +
                      '<b>Prompt</b>: %{text}<br>' +
                      '<extra></extra>'
    ))

    fig.update_layout(
        title="Prompt Evaluation Scores",
        xaxis_title="Prompt Index",
        yaxis_title="Score (1-1000)",
        hovermode='closest',
        height=600,
        width=1200
    )

    fig.show()